<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>L-—Å–∏—Å—Ç–µ–º—ã: –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Ñ—Ä–∞–∫—Ç–∞–ª–æ–≤ –∏ –º–æ–¥–µ–ª–µ–π —Ä–æ—Å—Ç–∞ —Ä–∞—Å—Ç–µ–Ω–∏–π</title>
    
    <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Å—Ç–∏–ª–µ–π -->
    <link rel="stylesheet" href="styles.css">
    
    <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ Three.js –¥–ª—è 3D —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <!-- OrbitControls –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è 3D –∫–∞–º–µ—Ä–æ–π -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/controls/OrbitControls.js"></script>
</head>
<body>
    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è -->
    <div class="app-container">
        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è -->
        <header class="app-header">
            <h1>L-—Å–∏—Å—Ç–µ–º—ã: –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Ñ—Ä–∞–∫—Ç–∞–ª–æ–≤</h1>
            <div class="theme-toggle">
                <button id="themeToggle" class="theme-btn">üåô –¢—ë–º–Ω–∞—è —Ç–µ–º–∞</button>
            </div>
        </header>

        <!-- –û—Å–Ω–æ–≤–Ω–∞—è –æ–±–ª–∞—Å—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ -->
        <main class="main-content">
            <!-- –û–±–ª–∞—Å—Ç—å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ -->
            <section class="visualization-section">
                <!-- –í–∫–ª–∞–¥–∫–∏ –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –º–µ–∂–¥—É 2D –∏ 3D —Ä–µ–∂–∏–º–∞–º–∏ -->
                <div class="visualization-tabs">
                    <button class="tab-button active" data-tab="2d">2D –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è</button>
                    <button class="tab-button" data-tab="3d">3D –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è</button>
                </div>
                
                <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ -->
                <div class="visualization-container">
                    <!-- 2D Canvas -->
                    <canvas id="canvas2d" class="visualization-canvas active" width="800" height="600">
                        –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —ç–ª–µ–º–µ–Ω—Ç canvas.
                    </canvas>
                    
                    <!-- 3D –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä -->
                    <div id="container3d" class="visualization-canvas" style="display: none;">
                        <div class="loading-message">
                            –ó–∞–≥—Ä—É–∑–∫–∞ 3D –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏...
                        </div>
                    </div>

                    <!-- –°–∫—Ä—ã—Ç—ã–π –¥–∏—Å–ø–ª–µ–π –æ—à–∏–±–æ–∫ -->
                    <div id="errorDisplay" class="error-display" style="display: none;"></div>
                </div>
            </section>

            <!-- –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è -->
            <section class="control-panel">
                <div class="panel-section">
                    <h3>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏—Å—Ç–µ–º—ã</h3>
                    
                    <div class="input-group">
                        <label for="axiomInput">–ê–∫—Å–∏–æ–º–∞:</label>
                        <input type="text" id="axiomInput" value="F" placeholder="–ù–∞—á–∞–ª—å–Ω–∞—è —Å—Ç—Ä–æ–∫–∞">
                    </div>

                    <div class="input-group">
                        <label for="rulesInput">–ü—Ä–∞–≤–∏–ª–∞:</label>
                        <textarea id="rulesInput" placeholder="F->FF-[-F+F+F]&#10;X->F[+X]F[-X]+X&#10;F->FF[70%]|F[+F]F[30%] (–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–Ω–æ–µ)">F->F+F--F+F</textarea>
                        <small style="color: var(--text-muted); margin-top: 5px; display: block;">
                            –§–æ—Ä–º–∞—Ç: A->B –∏–ª–∏ A->B[50%]|C[50%] –¥–ª—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–Ω—ã—Ö –ø—Ä–∞–≤–∏–ª
                        </small>
                    </div>

                    <div class="input-group">
                        <label for="angleInput">–£–≥–æ–ª –ø–æ–≤–æ—Ä–æ—Ç–∞ (¬∞):</label>
                        <input type="number" id="angleInput" value="60" min="0" max="180">
                    </div>

                    <div class="input-group">
                        <label for="iterationsInput">–ò—Ç–µ—Ä–∞—Ü–∏–∏:</label>
                        <input type="number" id="iterationsInput" value="4" min="1" max="15">
                    </div>
                </div>

                <!-- –ù–û–í–ê–Ø –°–ï–ö–¶–ò–Ø: –°—Ç–æ—Ö–∞—Å—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–∂–∏–º -->
                <div class="panel-section">
                    <h3>üé≤ –°—Ç–æ—Ö–∞—Å—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–∂–∏–º</h3>
                    <div class="input-group">
                        <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                            <input type="checkbox" id="stochasticToggle">
                            <span>–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞</span>
                        </label>
                    </div>
                    <div class="input-group" id="randomSeedGroup" style="display: none;">
                        <label for="randomSeedInput">Random Seed:</label>
                        <input type="number" id="randomSeedInput" value="12345" min="1">
                        <button id="randomizeSeedBtn" class="btn btn-outline" style="margin-top: 5px; width: 100%;">üé≤ –°–ª—É—á–∞–π–Ω—ã–π Seed</button>
                    </div>
                    <div class="input-group">
                        <button id="regenerateStochasticBtn" class="btn btn-outline" style="width: 100%;">üîÑ –ü–µ—Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å</button>
                    </div>
                </div>

                <!-- –ù–û–í–ê–Ø –°–ï–ö–¶–ò–Ø: 3D –†–µ–∂–∏–º -->
                <div class="panel-section">
                    <h3>üåê 3D –†–µ–∂–∏–º</h3>                                                         
                    <div class="input-group">
                        <button id="resetCameraBtn" class="btn btn-outline" style="width: 100%;">üì∑ –°–±—Ä–æ—Å –∫–∞–º–µ—Ä—ã</button>
                    </div>
                    <div class="input-group">
                        <small style="color: var(--text-muted); display: block;">
                            3D –∫–æ–º–∞–Ω–¥—ã: & (pitch down), ^ (pitch up), \ (roll left), / (roll right)
                        </small>
                    </div>
                </div>

                <div class="panel-section">
                    <h3>üéØ –ü—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–∫–∏</h3>
                    <select id="presetSelect" class="preset-select">
                        <option value="custom">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è</option>
                        <option value="koch" selected>‚ùÑÔ∏è –°–Ω–µ–∂–∏–Ω–∫–∞ –ö–æ—Ö–∞</option>
                        <option value="plant">üåø –í–µ—Ç–∫–∞ —Ä–∞—Å—Ç–µ–Ω–∏—è</option>
                        <option value="dragon">üêâ –î—Ä–∞–∫–æ–Ω –•–∞—Ä—Ç–µ—Ä–∞-–•–µ–π—Ç—É—ç—è</option>
                        <option value="sierpinski">üî∫ –¢—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫ –°–µ—Ä–ø–∏–Ω—Å–∫–æ–≥–æ</option>
                        <option value="bush">üåø –ö—É—Å—Ç</option>
                        <option value="fractalTree">üéÑ –§—Ä–∞–∫—Ç–∞–ª—å–Ω–æ–µ –¥–µ—Ä–µ–≤–æ</option>
                        <option value="weed">üå± –°–æ—Ä–Ω—è–∫</option>
                        
                        <!-- –ù–û–í–´–ï –û–ë–™–ï–ú–ù–´–ï 3D –î–ï–†–ï–í–¨–Ø -->
                        <option value="tree3d_pine">üéÑ –ï–ª—å </option>
                        
                        <!-- –ù–û–í–´–ï –°–¢–û–•–ê–°–¢–ò–ß–ï–°–ö–ò–ï –°–ò–°–¢–ï–ú–´ -->
                        <option value="stochastic_tree">üé≤ –°—Ç–æ—Ö–∞—Å—Ç–∏—á–µ—Å–∫–æ–µ –¥–µ—Ä–µ–≤–æ</option>
                        <option value="stochastic_weed">üé≤ –°—Ç–æ—Ö–∞—Å—Ç–∏—á–µ—Å–∫–∏–π —Å–æ—Ä–Ω—è–∫</option>
                    </select>
                </div>

                <div class="panel-section">
                    <h3>üéõÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–Ω–∏–º–∞—Ü–∏–µ–π</h3>
                    
                    <!-- –ü–æ–ª–∑—É–Ω–æ–∫ —Å–∫–æ—Ä–æ—Å—Ç–∏ -->
                    <div class="speed-control">
                        <label for="speedSlider">–°–∫–æ—Ä–æ—Å—Ç—å –∞–Ω–∏–º–∞—Ü–∏–∏:</label>
                        <input type="range" id="speedSlider" class="speed-slider" 
                               min="1" max="10" value="5">
                        <div class="speed-labels">
                            <span>–ú–µ–¥–ª–µ–Ω–Ω–æ</span>
                            <span>–ë—ã—Å—Ç—Ä–æ</span>
                        </div>
                    </div>

                    <!-- –°—á–µ—Ç—á–∏–∫–∏ -->
                    <div class="counters">
                        <div class="counter">
                            <label>–¢–µ–∫—É—â–∏–π —à–∞–≥:</label>
                            <span id="stepCounter">0</span>
                        </div>
                        <div class="counter">
                            <label>–í—Ä–µ–º—è:</label>
                            <span id="timerDisplay">0–º—Å</span>
                        </div>
                    </div>

                    <!-- –ù–û–í–´–ï –°–¢–ê–¢–ò–°–¢–ò–ö–ò -->
                    <div class="counters">
                        <div class="counter">
                            <label>–†–µ–∂–∏–º:</label>
                            <span id="modeDisplay">2D</span>
                        </div>
                        <div class="counter">
                            <label>–°—Ç–æ—Ö–∞—Å—Ç–∏–∫–∞:</label>
                            <span id="stochasticDisplay">–ù–µ—Ç</span>
                        </div>
                    </div>
                </div>

                <div class="panel-section">
                    <h3>üöÄ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</h3>
                    <div class="control-buttons">
                        <button id="startBtn" class="btn btn-primary">‚ñ∂Ô∏è –°—Ç–∞—Ä—Ç</button>
                        <button id="stopBtn" class="btn btn-secondary">‚è∏Ô∏è –°—Ç–æ–ø</button>
                        <button id="stepBtn" class="btn btn-outline">‚è≠Ô∏è –ü–æ—à–∞–≥–æ–≤–æ</button>
                        <button id="resetBtn" class="btn btn-outline">üîÑ –°–±—Ä–æ—Å</button>
                    </div>
                </div>

                <!-- –ù–û–í–ê–Ø –°–ï–ö–¶–ò–Ø: –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∏—Å—Ç–µ–º–µ -->
                <div class="panel-section">
                    <h3>üìä –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
                    <div class="counters">
                        <div class="counter">
                            <label>–î–ª–∏–Ω–∞ —Å—Ç—Ä–æ–∫–∏:</label>
                            <span id="stringLengthDisplay">0</span>
                        </div>
                        <div class="counter">
                            <label>–ö–æ–º–∞–Ω–¥:</label>
                            <span id="commandsDisplay">0</span>
                        </div>
                    </div>
                    <div class="input-group">
                        <small style="color: var(--text-muted); display: block;">
                            –í–µ—Ä—Å–∏—è: 2.0 | 3D + –°—Ç–æ—Ö–∞—Å—Ç–∏–∫–∞
                        </small>
                    </div>
                </div>
            </section>
        </main>

        <!-- –ù–∏–∂–Ω–∏–π –∫–æ–ª–æ–Ω—Ç–∏—Ç—É–ª -->
        <footer class="app-footer">
            <div class="app-info">
                <span>–ù–ò–Ø–£ –ú–ò–§–ò - –ö—É—Ä—Å "–ê–≤—Ç–æ–º–∞—Ç—ã" | –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è —Å 3D –∏ —Å—Ç–æ—Ö–∞—Å—Ç–∏—á–µ—Å–∫–∏–º–∏ –ø—Ä–∞–≤–∏–ª–∞–º–∏</span>
            </div>
            <div class="app-info">
                <span>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ 3D: –õ–ö–ú - –≤—Ä–∞—â–µ–Ω–∏–µ, –ö–æ–ª–µ—Å–∏–∫–æ - zoom, –ü–ö–ú - –ø–∞–Ω–æ—Ä–∞–º–∏—Ä–æ–≤–∞–Ω–∏–µ</span>
            </div>
        </footer>
    </div>

    <!-- –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥—É–ª–µ–π -->
    <script src="js/core/LSystem.js"></script>
    <script src="js/core/Parser.js"></script>
    <script src="js/renderers/Renderer2D.js"></script>
    <script src="js/renderers/Renderer3D.js"></script>
    <script src="js/ui/ThemeManager.js"></script>
    <script src="js/ui/ControlPanel.js"></script>
    <script src="js/app.js"></script>
</body>
</html>